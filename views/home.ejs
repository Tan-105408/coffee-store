<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coffee Store</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header>
    <h1>Coffee Store</h1>
    <nav>
      <a href="/">Trang ch·ªß</a>
      <a href="/cart">Gi·ªè h√†ng</a>
      <a href="/checkout">Thanh to√°n</a>
      <a href="/auth/profile">H·ªì s∆°</a>
      <% if (user) { %>
        <span>üëã Xin ch√†o, <%= user.username %>!</span>
        <a href="/auth/logout">ƒêƒÉng xu·∫•t</a>
      <% } else { %>
        <a href="/auth/login">ƒêƒÉng nh·∫≠p</a>
        <a href="/auth/register">ƒêƒÉng k√Ω</a>
      <% } %>
    </nav>
  </header>

  <main>
    <div class="search-filter-container">
      <form action="/" method="GET">
        <input type="text" name="search" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..." value="<%= typeof search !== 'undefined' ? search : '' %>">
        <select name="category">
          <option value="">T·∫•t c·∫£ danh m·ª•c</option>
          <option value="coffee" <%= category === 'coffee' ? 'selected' : '' %>>C√† ph√™</option>
          <option value="tea" <%= category === 'tea' ? 'selected' : '' %>>Tr√†</option>
          <option value="smoothie" <%= category === 'smoothie' ? 'selected' : '' %>>Sinh t·ªë</option>
          <option value="juice" <%= category === 'juice' ? 'selected' : '' %>>N∆∞·ªõc √©p</option>
          <option value="yogurt" <%= category === 'yogurt' ? 'selected' : '' %>>S·ªØa chua</option>
          <option value="water" <%= category === 'water' ? 'selected' : '' %>>N∆∞·ªõc su·ªëi</option>
          <option value="chocolate" <%= category === 'chocolate' ? 'selected' : '' %>>Chocolate</option>
        </select>
        <input type="number" name="minPrice" placeholder="Gi√° t·ªëi thi·ªÉu" value="<%= typeof minPrice !== 'undefined' ? minPrice : '' %>">
        <input type="number" name="maxPrice" placeholder="Gi√° t·ªëi ƒëa" value="<%= typeof maxPrice !== 'undefined' ? maxPrice : '' %>">
        <button type="submit">T√¨m ki·∫øm</button>
      </form>
    </div>

    <h2>Danh s√°ch s·∫£n ph·∫©m</h2>
    <div class="product-grid container">
      <% if (products && products.length > 0) { %>
        <% products.forEach(product => { %>
          <div class="product">
            <img src="<%= product.image %>" alt="<%= product.name %>" width="150" style="margin: 10px">
            <h3><%= product.name %></h3>
            <% if (product.discount > 0) { %>
              <p>Gi√° g·ªëc: <del><%= product.price %> VND</del></p>
              <p>Gi√° gi·∫£m: <%= (product.price * (1 - product.discount / 100)).toFixed(0) %> VND</p>
            <% } else { %>
              <p>Gi√°: <%= product.price %> VND</p>
            <% } %>
            <div class="product-buttons">
              <button class="product-button" onclick="location.href='/product/<%= product._id %>'">Xem chi ti·∫øt</button>
              <button class="product-button add-to-cart" data-id="<%= product._id %>">Th√™m v√†o gi·ªè h√†ng</button>
            </div>
          </div>
        <% }); %>
      <% } else { %>
        <p>Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o.</p>
      <% } %>
    </div>
  </main>

  <script src="/scripts.js"></script>
</body>
</html>
